<!DOCTYPE html>
<html>
  <head>
      <meta charset='utf-8' />
      <title>Jezuïeten in Nederland en Vlaanderen</title>
      <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
      <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,700' rel='stylesheet'>
      <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.44.2/mapbox-gl.js'></script>
      <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.44.2/mapbox-gl.css' rel='stylesheet' />
	<link rel="stylesheet" type="text/css" href="../scripts/style.css"/>

<style TYPE="text/css">
.linkCentre A
{
display: none; }
.popFlag IMG
{
	/*direction: ltr;*/
	height: 22px;
	width: 22px;
	float: right;
	/*padding-left: 5px;*/
	/*+placement: 2px -5px;*/
	position: relative;
	left: 2px;
	top: -5px;
}

</style>

   </head>
  <body>

   
<div id='map' class='map'>


</div>
<div id='menu'>
    <input id='light' type='radio' name='rtoggle' value='light' checked='checked'>
    <label for='light'>light</label>
    <input id='basic' type='radio' name='rtoggle' value='basic'>
    <label for='basic'>basic</label>
    <input id='streets' type='radio' name='rtoggle' value='streets'>
    <label for='streets'>streets</label>
    <input id='bright' type='radio' name='rtoggle' value='bright'>
    <label for='bright'>bright</label>
    <input id='dark' type='radio' name='rtoggle' value='dark'>
    <label for='dark'>dark</label>
    <input id='satellite' type='radio' name='rtoggle' value='satellite'>
    <label for='satellite'>satellite</label>
</div>
<div class='sidebar'>
    <div class='heading'>
    	<h1>Jezuïeten in Nederland en Vlaanderen</h1>
    </div>
    <div id='listings' class='listings'>
    </div>
</div>

  <script>
  // This will let you use the .remove() function later on
  if (!('remove' in Element.prototype)) {
    Element.prototype.remove = function() {
      if (this.parentNode) {
          this.parentNode.removeChild(this);
      }
    };
  }

mapboxgl.accessToken = 'pk.eyJ1IjoiZXhhbXBsZXMiLCJhIjoiY2lqbmpqazdlMDBsdnRva284cWd3bm11byJ9.V6Hg2oYJwMAxeoR9GEzkAA';

var map = new mapboxgl.Map({
    container: 'map',
    style: 'mapbox://styles/mapbox/light-v9',
    zoom: 7,
    scrollZoom: true,
	center: [4.8959349, 51.734558],
});

var layerList=document.getElementById("menu"),inputs=layerList.getElementsByTagName("input");function switchLayer(t){var e=t.target.id;map.setStyle("mapbox://styles/mapbox/"+e+"-v9")}for(var i=0;i<inputs.length;i++)inputs[i].onclick=switchLayer;
 
map.addControl(new mapboxgl.NavigationControl());

  var stores = 
 // Paste below until file has geojson has url


{"type":"FeatureCollection","features":[{"type":"Feature","geometry":{"type":"Point","coordinates":[4.8741682,52.354048]},"properties":{"Community":"Residentie","Province":"Residentie, De Lairessestraat 61","City":"Amsterdam","Country":"Nederlands","Phone":"","Address":"Residentie, De Lairessestraat 61, Amsterdam","marker-color":"#000080","marker-symbol":"","marker-size":""}},{"type":"Feature","geometry":{"type":"Point","coordinates":[4.8880346,52.3677581]},"properties":{"Community":"Xaverius","Province":"Xaverius, Singel 448","City":"Amsterdam","Country":"Nederlands","Phone":"","Address":"Xaverius, Singel 448, Amsterdam","marker-color":"#FF0000","marker-symbol":"","marker-size":""}},{"type":"Feature","geometry":{"type":"Point","coordinates":[5.8671279,51.8121706]},"properties":{"Community":"Aqua Viva","Province":"Aqua Viva, Heyendaalseweg 290","City":"Nijmegen","Country":"Nederlands","Phone":"","Address":"Aqua Viva, Heyendaalseweg 290, Nijmegen","marker-color":"#000080","marker-symbol":"","marker-size":""}},{"type":"Feature","geometry":{"type":"Point","coordinates":[4.4085165,51.2160595]},"properties":{"Community":"Agora","Province":"Agora, Graanmarkt 9-11","City":"Antwerpen","Country":"Vlaanderen","Phone":"","Address":"Agora, Graanmarkt 9-11, Antwerpen","marker-color":"#FF0000","marker-symbol":"","marker-size":""}},{"type":"Feature","geometry":{"type":"Point","coordinates":[4.4112386,51.2225335]},"properties":{"Community":"Loyola","Province":"Loyola, Grote Kauwenberg 30","City":"Antwerpen","Country":"Vlaanderen","Phone":"","Address":"Loyola, Grote Kauwenberg 30, Antwerpen","marker-color":"#FF0000","marker-symbol":"","marker-size":""}},{"type":"Feature","geometry":{"type":"Point","coordinates":[4.4108822,51.2222339]},"properties":{"Community":"Romero","Province":"Romero, Prinsstraat 17","City":"Antwerpen","Country":"Vlaanderen","Phone":"","Address":"Romero, Prinsstraat 17, Antwerpen","marker-color":"#FF0000","marker-symbol":"","marker-size":""}},{"type":"Feature","geometry":{"type":"Point","coordinates":[4.4901914,51.1719876]},"properties":{"Community":"Xaverius In Capenberg","Province":"Xaverius in Capenberg, Borsbeeksesteenweg 45","City":"Boechout","Country":"Vlaanderen","Phone":"","Address":"Xaverius in Capenberg, Borsbeeksesteenweg 45, Boechout","marker-color":"#FF0000","marker-symbol":"","marker-size":""}},{"type":"Feature","geometry":{"type":"Point","coordinates":[4.3517211,50.8503463]},"properties":{"Community":"Arrupe","Province":"Arrupe, Koninginnelaan 141","City":"Brussel","Country":"Vlaanderen","Phone":"","Address":"Arrupe, Koninginnelaan 141, Brussel","marker-color":"#FF0000","marker-symbol":"","marker-size":""}},{"type":"Feature","geometry":{"type":"Point","coordinates":[3.663736,51.049832]},"properties":{"Community":"Oude Abdij","Province":"Oude Abdij, Drongenplein 26-27","City":"Drongen - Gent","Country":"Vlaanderen","Phone":"","Address":"Oude Abdij, Drongenplein 26-27, Drongen - Gent","marker-color":"#FF0000","marker-symbol":"","marker-size":""}},{"type":"Feature","geometry":{"type":"Point","coordinates":[4.3488683,50.8417737]},"properties":{"Community":"Sint-Jan Berchmans","Province":"Sint-Jan Berchmans, Waversebaan 220","City":"Heverlee","Country":"Vlaanderen","Phone":"","Address":"Sint-Jan Berchmans, Waversebaan 220, Heverlee","marker-color":"#FF0000","marker-symbol":"","marker-size":""}},{"type":"Feature","geometry":{"type":"Point","coordinates":[4.7119641,50.8738099]},"properties":{"Community":"Lessius","Province":"Lessius, Windmolenveldstraat 44","City":"Leuven","Country":"Vlaanderen","Phone":"","Address":"Lessius, Windmolenveldstraat 44, Leuven","marker-color":"#FF0000","marker-symbol":"","marker-size":""}},{"type":"Feature","geometry":{"type":"Point","coordinates":[4.3091691,50.8231128]},"properties":{"Community":"Pierre Favre","Province":"Pierre Favre, Maria Theresiastraat 92","City":"Leuven","Country":"Vlaanderen","Phone":"","Address":"Pierre Favre, Maria Theresiastraat 92 , Leuven","marker-color":"#FF0000","marker-symbol":"","marker-size":""}},{"type":"Feature","geometry":{"type":"Point","coordinates":[4.4810888,51.0258708]},"properties":{"Community":"Leliëndaal","Province":"Leliëndaal, Bruul 56","City":"Mechelen","Country":"Vlaanderen","Phone":"","Address":"Leliëndaal, Bruul 56, Mechelen","marker-color":"#FF0000","marker-symbol":"","marker-size":""}}]}
 

 //Paste above
;
    
map.on("load",function(e){map.addSource("places",{type:"geojson",data:stores}),buildLocationList(stores)}),stores.features.forEach(function(a,o){var e=document.createElement("div");e.id="marker-"+o,e.className="marker",new mapboxgl.Marker(e,{offset:[0,-23]}).setLngLat(a.geometry.coordinates).addTo(map),e.addEventListener("click",function(e){flyToStore(a),createPopUp(a);var t=document.getElementsByClassName("active");e.stopPropagation(),t[0]&&t[0].classList.remove("active"),document.getElementById("listing-"+o).classList.add("active")})});
function flyToStore(o){map.flyTo({center:o.geometry.coordinates,zoom:13})}

  function createPopUp(currentFeature) {
    var popUps = document.getElementsByClassName('mapboxgl-popup');
    var prop = currentFeature.properties;

    var lowCountry = prop.Country.toLowerCase(); 
    if (popUps[0]) popUps[0].remove();
    var popup = new mapboxgl.Popup({closeOnClick: false})
          .setLngLat(currentFeature.geometry.coordinates)
//Popup elements
          .setHTML('<h3>' + currentFeature.properties.Community + '</h3>' +
            '<h4>' + currentFeature.properties.Address + '</h4><div class= "popFlag"><img src ="../scripts/svg/'+ lowCountry +'.svg"</div><div class= "linkCentre"><a target = "blank" href = "http://'+ currentFeature.properties.Web +'">'+ currentFeature.properties.Web +'</a></div>'
            )
          .addTo(map);
  }

function buildLocationList(data) {
    for (i = 0; i < data.features.length; i++) {
      var currentFeature = data.features[i];
      var prop = currentFeature.properties;

      var listings = document.getElementById('listings');
//to avoid renaming SVGs to capitalised
var lowCountry = prop.Country.toLowerCase(); 
      var listing = listings.appendChild(document.createElement('div'));
      listing.className = 'item';
      listing.id = "listing-" + i;
      var link = listing.appendChild(document.createElement('a'));
      link.href = '#';
      link.className = 'title';
      link.dataPosition = i;
      link.innerHTML = prop.Community;

      var details = listing.appendChild(document.createElement('div'));
// Country CSS and name
      details.innerHTML =  '<div class = "country">' +  prop.Country + '<div class= "flag"><img src ="../scripts/svg/'+ lowCountry +'.svg"</div></div>';
//      if (prop.Centre) {
//        details.innerHTML += ' &middot; ' + prop.Address;
//      }

link.addEventListener("click",function(e){var t=data.features[this.dataPosition];flyToStore(t),createPopUp(t);var a=document.getElementsByClassName("active");a[0]&&a[0].classList.remove("active"),this.parentNode.classList.add("active")});}}
    </script>
  </body>
</html>
